import{s as _e,f as C,a as A,l as W,g as E,h as $,c as I,m as K,d as k,j as N,U as w,i as j,u as d,n as V,T as ee,I as Pe,o as ye,p as x,e as Q,R as Ce,K as q}from"../chunks/scheduler.2996579b.js";import{S as de,i as pe,a as y,g as B,t as H,c as Y,b as z,d as G,m as F,e as J}from"../chunks/index.00b56f8c.js";import{e as se}from"../chunks/each.4e61ef43.js";import{a as ve,K as Ee}from"../chunks/KTextArea.86e1920a.js";import{u as Ne}from"../chunks/stores.88811b96.js";import{g as He}from"../chunks/navigation.5445e84d.js";import{f as $e}from"../chunks/alerts.73a0c392.js";import{g as re,a as De,s as Me,b as Se}from"../chunks/convo.88f2ed95.js";function ae(n){let e,s;return e=new ve({props:{src:n[1]}}),{c(){z(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,r){F(e,t,r),s=!0},p(t,r){const i={};r&2&&(i.src=t[1]),e.$set(i)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){H(e.$$.fragment,t),s=!1},d(t){J(e,t)}}}function oe(n){let e,s;return e=new ve({props:{src:n[1]}}),{c(){z(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,r){F(e,t,r),s=!0},p(t,r){const i={};r&2&&(i.src=t[1]),e.$set(i)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){H(e.$$.fragment,t),s=!1},d(t){J(e,t)}}}function Ue(n){let e,s,t,r,i,a=n[2].author+"",l,o,m,v=n[2].humanTime()+"",D,S,p,b=n[2].text+"",T,U,f,c=!n[0]&&ae(n),g=n[0]&&oe(n);return{c(){e=C("div"),c&&c.c(),s=A(),t=C("div"),r=C("header"),i=C("p"),l=W(a),o=A(),m=C("p"),D=W(v),S=A(),p=C("p"),T=W(b),U=A(),g&&g.c(),this.h()},l(h){e=E(h,"DIV",{class:!0});var u=$(e);c&&c.l(u),s=I(u),t=E(u,"DIV",{class:!0});var R=$(t);r=E(R,"HEADER",{class:!0});var _=$(r);i=E(_,"P",{class:!0});var P=$(i);l=K(P,a),P.forEach(k),o=I(_),m=E(_,"P",{class:!0});var M=$(m);D=K(M,v),M.forEach(k),_.forEach(k),S=I(R),p=E(R,"P",{class:!0});var L=$(p);T=K(L,b),L.forEach(k),R.forEach(k),U=I(u),g&&g.l(u),u.forEach(k),this.h()},h(){N(i,"class","font-bold text-xs lg:text-base mr-4"),N(m,"class","text-xs lg:text-base"),N(r,"class","flex justify-between items-center"),N(p,"class","text-xs lg:text-base"),N(t,"class","card p-2 lg:p-4 space-y-2"),w(t,"rounded-tr-none",n[0]),w(t,"rounded-tl-none",!n[0]),w(t,"variant-filled-primary",n[0]),w(t,"variant-soft",!n[0]),N(e,"class","grid lg:gap-2"),w(e,"grid-cols-[1fr_auto_auto]",n[0]),w(e,"grid-cols-[auto_auto_1fr]",!n[0]),w(e,"justify-items-end",n[0]),w(e,"text-right",n[0]),w(e,"text-left",!n[0])},m(h,u){j(h,e,u),c&&c.m(e,null),d(e,s),d(e,t),d(t,r),d(r,i),d(i,l),d(r,o),d(r,m),d(m,D),d(t,S),d(t,p),d(p,T),d(e,U),g&&g.m(e,null),f=!0},p(h,[u]){h[0]?c&&(B(),H(c,1,1,()=>{c=null}),Y()):c?(c.p(h,u),u&1&&y(c,1)):(c=ae(h),c.c(),y(c,1),c.m(e,s)),(!f||u&4)&&a!==(a=h[2].author+"")&&V(l,a),(!f||u&4)&&v!==(v=h[2].humanTime()+"")&&V(D,v),(!f||u&4)&&b!==(b=h[2].text+"")&&V(T,b),(!f||u&1)&&w(t,"rounded-tr-none",h[0]),(!f||u&1)&&w(t,"rounded-tl-none",!h[0]),(!f||u&1)&&w(t,"variant-filled-primary",h[0]),(!f||u&1)&&w(t,"variant-soft",!h[0]),h[0]?g?(g.p(h,u),u&1&&y(g,1)):(g=oe(h),g.c(),y(g,1),g.m(e,null)):g&&(B(),H(g,1,1,()=>{g=null}),Y()),(!f||u&1)&&w(e,"grid-cols-[1fr_auto_auto]",h[0]),(!f||u&1)&&w(e,"grid-cols-[auto_auto_1fr]",!h[0]),(!f||u&1)&&w(e,"justify-items-end",h[0]),(!f||u&1)&&w(e,"text-right",h[0]),(!f||u&1)&&w(e,"text-left",!h[0])},i(h){f||(y(c),y(g),f=!0)},o(h){H(c),H(g),f=!1},d(h){h&&k(e),c&&c.d(),g&&g.d()}}}function Ae(n,e,s){let{isThisUser:t}=e,{src:r}=e,{msg:i}=e;return n.$$set=a=>{"isThisUser"in a&&s(0,t=a.isThisUser),"src"in a&&s(1,r=a.src),"msg"in a&&s(2,i=a.msg)},[t,r,i]}class we extends de{constructor(e){super(),pe(this,e,Ae,Ue,_e,{isThisUser:0,src:1,msg:2})}}var Ie=Object.defineProperty,Re=(n,e)=>{for(var s in e)Ie(n,s,{get:e[s],enumerable:!0})},be=(n,e,s)=>{if(!e.has(n))throw TypeError("Cannot "+s)},ie=(n,e,s)=>(be(n,e,"read from private field"),s?s.call(n):e.get(n)),je=(n,e,s)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,s)},Le=(n,e,s,t)=>(be(n,e,"write to private field"),t?t.call(n,s):e.set(n,s),s),Oe={};Re(Oe,{Channel:()=>ke,PluginListener:()=>Te,addPluginListener:()=>Ke,convertFileSrc:()=>Ve,invoke:()=>Z,transformCallback:()=>X});function We(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function X(n,e=!1){let s=We(),t=`_${s}`;return Object.defineProperty(window,t,{value:r=>(e&&Reflect.deleteProperty(window,t),n==null?void 0:n(r)),writable:!1,configurable:!0}),s}var O,ke=class{constructor(){this.__TAURI_CHANNEL_MARKER__=!0,je(this,O,()=>{}),this.id=X(n=>{ie(this,O).call(this,n)})}set onmessage(n){Le(this,O,n)}get onmessage(){return ie(this,O)}toJSON(){return`__CHANNEL__:${this.id}`}};O=new WeakMap;var Te=class{constructor(n,e,s){this.plugin=n,this.event=e,this.channelId=s}async unregister(){return Z(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}};async function Ke(n,e,s){let t=new ke;return t.onmessage=s,Z(`plugin:${n}|register_listener`,{event:e,handler:t}).then(()=>new Te(n,e,t.id))}async function Z(n,e={}){return new Promise((s,t)=>{let r=X(a=>{s(a),Reflect.deleteProperty(window,`_${i}`)},!0),i=X(a=>{t(a),Reflect.deleteProperty(window,`_${r}`)},!0);window.__TAURI_IPC__({cmd:n,callback:r,error:i,...e})})}function Ve(n,e="asset"){let s=encodeURIComponent(n);return navigator.userAgent.includes("Windows")?`https://${e}.localhost/${s}`:`${e}://localhost/${s}`}var le;(function(n){n.Year="Year",n.Month="Month",n.TwoWeeks="TwoWeeks",n.Week="Week",n.Day="Day",n.Hour="Hour",n.Minute="Minute",n.Second="Second"})(le||(le={}));var fe;(function(n){n[n.None=0]="None",n[n.Min=1]="Min",n[n.Low=2]="Low",n[n.Default=3]="Default",n[n.High=4]="High"})(fe||(fe={}));var ue;(function(n){n[n.Secret=-1]="Secret",n[n.Private=0]="Private",n[n.Public=1]="Public"})(ue||(ue={}));async function qe(){return window.Notification.permission!=="default"?Promise.resolve(window.Notification.permission==="granted"):Z("plugin:notification|is_permission_granted")}async function Be(){return window.Notification.requestPermission()}function ce(n){typeof n=="string"?new window.Notification(n):new window.Notification(n.title,n)}function he(n,e,s){const t=n.slice();return t[14]=e[s],t}function Ye(n){let e,s,t=se(n[5]),r=[];for(let a=0;a<t.length;a+=1)r[a]=me(he(n,t,a));const i=a=>H(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();e=Q()},l(a){for(let l=0;l<r.length;l+=1)r[l].l(a);e=Q()},m(a,l){for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(a,l);j(a,e,l),s=!0},p(a,l){if(l&98){t=se(a[5]);let o;for(o=0;o<t.length;o+=1){const m=he(a,t,o);r[o]?(r[o].p(m,l),y(r[o],1)):(r[o]=me(m),r[o].c(),y(r[o],1),r[o].m(e.parentNode,e))}for(B(),o=t.length;o<r.length;o+=1)i(o);Y()}},i(a){if(!s){for(let l=0;l<t.length;l+=1)y(r[l]);s=!0}},o(a){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)H(r[l]);s=!1},d(a){a&&k(e),Ce(r,a)}}}function ze(n){let e,s="Please Wait...";return{c(){e=C("p"),e.textContent=s,this.h()},l(t){e=E(t,"P",{class:!0,["data-svelte-h"]:!0}),ee(e)!=="svelte-n9uvbj"&&(e.textContent=s),this.h()},h(){N(e,"class","p w-full")},m(t,r){j(t,e,r)},p:q,i:q,o:q,d(t){t&&k(e)}}}function Ge(n){let e,s;return e=new we({props:{isThisUser:!1,src:n[1][n[14].author].photo,msg:n[14]}}),{c(){z(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,r){F(e,t,r),s=!0},p(t,r){const i={};r&34&&(i.src=t[1][t[14].author].photo),r&32&&(i.msg=t[14]),e.$set(i)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){H(e.$$.fragment,t),s=!1},d(t){J(e,t)}}}function Fe(n){let e,s;return e=new we({props:{isThisUser:!0,src:n[6].photo,msg:n[14]}}),{c(){z(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,r){F(e,t,r),s=!0},p(t,r){const i={};r&64&&(i.src=t[6].photo),r&32&&(i.msg=t[14]),e.$set(i)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){H(e.$$.fragment,t),s=!1},d(t){J(e,t)}}}function Je(n){let e,s,t,r=n[14].text+" - "+n[14].humanTime(),i,a;return{c(){e=C("div"),s=C("div"),t=C("p"),i=W(r),a=A(),this.h()},l(l){e=E(l,"DIV",{class:!0});var o=$(e);s=E(o,"DIV",{class:!0});var m=$(s);t=E(m,"P",{class:!0});var v=$(t);i=K(v,r),v.forEach(k),m.forEach(k),a=I(o),o.forEach(k),this.h()},h(){N(t,"class","text-xs lg:text-base"),N(s,"class","border-0 space-y-2 w-full mb-4 variant-filled-surface p-2 w-9/12 mx-auto rounded-xl"),N(e,"class","grid gap-4 text-center w-full")},m(l,o){j(l,e,o),d(e,s),d(s,t),d(t,i),d(e,a)},p(l,o){o&32&&r!==(r=l[14].text+" - "+l[14].humanTime())&&V(i,r)},i:q,o:q,d(l){l&&k(e)}}}function me(n){let e,s,t,r;const i=[Je,Fe,Ge],a=[];function l(o,m){return o[14].author==="SYSTEM"?0:o[14].author===o[6].name?1:2}return e=l(n),s=a[e]=i[e](n),{c(){s.c(),t=Q()},l(o){s.l(o),t=Q()},m(o,m){a[e].m(o,m),j(o,t,m),r=!0},p(o,m){let v=e;e=l(o),e===v?a[e].p(o,m):(B(),H(a[v],1,1,()=>{a[v]=null}),Y(),s=a[e],s?s.p(o,m):(s=a[e]=i[e](o),s.c()),y(s,1),s.m(t.parentNode,t))},i(o){r||(y(s),r=!0)},o(o){H(s),r=!1},d(o){o&&k(t),a[e].d(o)}}}function Qe(n){let e,s,t,r="arrow_back_ios",i,a,l=(n[2]?n[2]:"Loading...")+"",o,m,v,D="settings",S,p,b,T,U,f,c,g;const h=[ze,Ye],u=[];function R(_,P){return!_[6].name||!_[1]||!_[5].length?0:1}return b=R(n),T=u[b]=h[b](n),c=new Ee({props:{onclick:n[7],sendOnEnter:!0}}),{c(){e=C("div"),s=C("div"),t=C("a"),t.textContent=r,i=A(),a=C("h3"),o=W(l),m=A(),v=C("button"),v.textContent=D,S=A(),p=C("section"),T.c(),U=A(),f=C("div"),z(c.$$.fragment),this.h()},l(_){e=E(_,"DIV",{class:!0});var P=$(e);s=E(P,"DIV",{class:!0});var M=$(s);t=E(M,"A",{class:!0,href:!0,["data-svelte-h"]:!0}),ee(t)!=="svelte-1rqzvvg"&&(t.textContent=r),i=I(M),a=E(M,"H3",{class:!0});var L=$(a);o=K(L,l),L.forEach(k),m=I(M),v=E(M,"BUTTON",{class:!0,["data-svelte-h"]:!0}),ee(v)!=="svelte-1o7k9cj"&&(v.textContent=D),M.forEach(k),S=I(P),p=E(P,"SECTION",{class:!0});var te=$(p);T.l(te),te.forEach(k),U=I(P),f=E(P,"DIV",{});var ne=$(f);G(c.$$.fragment,ne),ne.forEach(k),P.forEach(k),this.h()},h(){N(t,"class","btn-icon material-symbols-outlined w-8 h-8"),N(t,"href","/chatrooms"),N(a,"class","h3 px-2 my-auto"),N(v,"class","material-symbols-outlined ml-auto mr-3 w-8 h-8 my-auto"),N(s,"class","h-auto flex flex-row variant-filled-primary mt-4 p-1"),N(p,"class","p-1 overflow-y-auto space-y-4"),w(p,"placeholder",!n[5].length),w(p,"animate-pulse",!n[5].length),N(e,"class","flex flex-col overflow-hidden px-4 lg:pl-0")},m(_,P){j(_,e,P),d(e,s),d(s,t),d(s,i),d(s,a),d(a,o),d(s,m),d(s,v),n[8](s),d(e,S),d(e,p),u[b].m(p,null),n[9](p),d(e,U),d(e,f),F(c,f,null),n[10](f),g=!0},p(_,[P]){(!g||P&4)&&l!==(l=(_[2]?_[2]:"Loading...")+"")&&V(o,l);let M=b;b=R(_),b===M?u[b].p(_,P):(B(),H(u[M],1,1,()=>{u[M]=null}),Y(),T=u[b],T?T.p(_,P):(T=u[b]=h[b](_),T.c()),y(T,1),T.m(p,null)),(!g||P&32)&&w(p,"placeholder",!_[5].length),(!g||P&32)&&w(p,"animate-pulse",!_[5].length)},i(_){g||(y(T),y(c.$$.fragment,_),g=!0)},o(_){H(T),H(c.$$.fragment,_),g=!1},d(_){_&&k(e),n[8](null),u[b].d(),n[9](null),J(c),n[10](null)}}}function ge(n){const e=n.offsetHeight,s=getComputedStyle(n),t=parseInt(s.getPropertyValue("margin-top")),r=parseInt(s.getPropertyValue("margin-bottom"));return e+t+r}function Xe(n,e,s){let t;Pe(n,Ne,f=>s(6,t=f));async function r(){let f=await qe();f||(f=await Be()==="granted"),f&&(ce("Tauri is awesome!"),ce({title:"TAURI",body:"Tauri is awesome!"}))}r();let i;var a;let l;var o,m;function v(){i?i.scrollTo({top:i.scrollHeight,behavior:"smooth"}):console.log(i)}var D=[];async function S(f){await Se(t.cid,f)}function p(){return window.innerHeight-ge(o)-ge(m)}window.addEventListener("resize",()=>{try{s(0,i.style.maxHeight=p().toString()+"px",i),s(0,i.style.minHeight=p().toString()+"px",i)}catch{}}),ye(async()=>{s(0,i.style.maxHeight=p().toString()+"px",i),s(0,i.style.minHeight=p().toString()+"px",i),t.token||$e("Open a chatroom first!",()=>{He("/chatrooms")});const f=await re(t.cid);s(1,a=f.users),s(2,l=f.name),s(5,D=await De(t.cid)),setTimeout(v,150),Me(t.cid,async c=>{Object.keys(a).includes(c.author)||s(1,a=(await re(t.cid)).users),s(5,D=[...D,c]),setTimeout(v,75)},D.length)});function b(f){x[f?"unshift":"push"](()=>{o=f,s(3,o)})}function T(f){x[f?"unshift":"push"](()=>{i=f,s(0,i)})}function U(f){x[f?"unshift":"push"](()=>{m=f,s(4,m)})}return[i,a,l,o,m,D,t,S,b,T,U]}class ot extends de{constructor(e){super(),pe(this,e,Xe,Qe,_e,{})}}export{ot as component};
