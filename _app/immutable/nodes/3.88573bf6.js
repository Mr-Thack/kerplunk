import{s as pe,f as C,a as I,l as W,g as E,h as H,c as R,m as L,d as b,j as N,U as v,i as O,u as m,n as q,T as we,C as Ne,I as He,o as $e,p as ee,e as X,R as De,K as B}from"../chunks/scheduler.2996579b.js";import{S as ve,i as be,a as P,g as Y,t as $,c as G,b as z,d as F,m as J,e as Q}from"../chunks/index.00b56f8c.js";import{e as ae}from"../chunks/each.4e61ef43.js";import{a as ke,K as Se,d as Me}from"../chunks/KTextArea.b9d9b606.js";import{u as Ue}from"../chunks/stores.88811b96.js";import{g as Ae}from"../chunks/navigation.8ca22a0a.js";import{f as Ie}from"../chunks/alerts.73a0c392.js";import{b as Te}from"../chunks/paths.f1cda1fb.js";import{g as oe,a as Re,s as je,b as We}from"../chunks/convo.79cf6ffa.js";function ie(n){let e,r;return e=new ke({props:{src:n[1]}}),{c(){z(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){J(e,t,s),r=!0},p(t,s){const i={};s&2&&(i.src=t[1]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){Q(e,t)}}}function le(n){let e,r;return e=new ke({props:{src:n[1]}}),{c(){z(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){J(e,t,s),r=!0},p(t,s){const i={};s&2&&(i.src=t[1]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){Q(e,t)}}}function Le(n){let e,r,t,s,i,a=n[2].author+"",f,o,h,p=n[2].humanTime()+"",D,U,w,k=n[2].text+"",T,A,g,l=!n[0]&&ie(n),u=n[0]&&le(n);return{c(){e=C("div"),l&&l.c(),r=I(),t=C("div"),s=C("header"),i=C("p"),f=W(a),o=I(),h=C("p"),D=W(p),U=I(),w=C("p"),T=W(k),A=I(),u&&u.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var d=H(e);l&&l.l(d),r=R(d),t=E(d,"DIV",{class:!0});var j=H(t);s=E(j,"HEADER",{class:!0});var S=H(s);i=E(S,"P",{class:!0});var K=H(i);f=L(K,a),K.forEach(b),o=R(S),h=E(S,"P",{class:!0});var _=H(h);D=L(_,p),_.forEach(b),S.forEach(b),U=R(j),w=E(j,"P",{class:!0});var y=H(w);T=L(y,k),y.forEach(b),j.forEach(b),A=R(d),u&&u.l(d),d.forEach(b),this.h()},h(){N(i,"class","font-bold text-xs lg:text-base mr-4"),N(h,"class","text-xs lg:text-base"),N(s,"class","flex justify-between items-center"),N(w,"class","text-xs lg:text-base"),N(t,"class","card p-2 lg:p-4 space-y-2"),v(t,"rounded-tr-none",n[0]),v(t,"rounded-tl-none",!n[0]),v(t,"variant-filled-primary",n[0]),v(t,"variant-soft",!n[0]),N(e,"class","grid lg:gap-2"),v(e,"grid-cols-[1fr_auto_auto]",n[0]),v(e,"grid-cols-[auto_auto_1fr]",!n[0]),v(e,"justify-items-end",n[0]),v(e,"text-right",n[0]),v(e,"text-left",!n[0])},m(c,d){O(c,e,d),l&&l.m(e,null),m(e,r),m(e,t),m(t,s),m(s,i),m(i,f),m(s,o),m(s,h),m(h,D),m(t,U),m(t,w),m(w,T),m(e,A),u&&u.m(e,null),g=!0},p(c,[d]){c[0]?l&&(Y(),$(l,1,1,()=>{l=null}),G()):l?(l.p(c,d),d&1&&P(l,1)):(l=ie(c),l.c(),P(l,1),l.m(e,r)),(!g||d&4)&&a!==(a=c[2].author+"")&&q(f,a),(!g||d&4)&&p!==(p=c[2].humanTime()+"")&&q(D,p),(!g||d&4)&&k!==(k=c[2].text+"")&&q(T,k),(!g||d&1)&&v(t,"rounded-tr-none",c[0]),(!g||d&1)&&v(t,"rounded-tl-none",!c[0]),(!g||d&1)&&v(t,"variant-filled-primary",c[0]),(!g||d&1)&&v(t,"variant-soft",!c[0]),c[0]?u?(u.p(c,d),d&1&&P(u,1)):(u=le(c),u.c(),P(u,1),u.m(e,null)):u&&(Y(),$(u,1,1,()=>{u=null}),G()),(!g||d&1)&&v(e,"grid-cols-[1fr_auto_auto]",c[0]),(!g||d&1)&&v(e,"grid-cols-[auto_auto_1fr]",!c[0]),(!g||d&1)&&v(e,"justify-items-end",c[0]),(!g||d&1)&&v(e,"text-right",c[0]),(!g||d&1)&&v(e,"text-left",!c[0])},i(c){g||(P(l),P(u),g=!0)},o(c){$(l),$(u),g=!1},d(c){c&&b(e),l&&l.d(),u&&u.d()}}}function Oe(n,e,r){let{isThisUser:t}=e,{src:s}=e,{msg:i}=e;return n.$$set=a=>{"isThisUser"in a&&r(0,t=a.isThisUser),"src"in a&&r(1,s=a.src),"msg"in a&&r(2,i=a.msg)},[t,s,i]}class ye extends ve{constructor(e){super(),be(this,e,Oe,Le,pe,{isThisUser:0,src:1,msg:2})}}var Ke=Object.defineProperty,Ve=(n,e)=>{for(var r in e)Ke(n,r,{get:e[r],enumerable:!0})},Pe=(n,e,r)=>{if(!e.has(n))throw TypeError("Cannot "+r)},fe=(n,e,r)=>(Pe(n,e,"read from private field"),r?r.call(n):e.get(n)),qe=(n,e,r)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,r)},Be=(n,e,r,t)=>(Pe(n,e,"write to private field"),t?t.call(n,r):e.set(n,r),r),Ye={};Ve(Ye,{Channel:()=>Ce,PluginListener:()=>Ee,addPluginListener:()=>ze,convertFileSrc:()=>Fe,invoke:()=>x,transformCallback:()=>Z});function Ge(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function Z(n,e=!1){let r=Ge(),t=`_${r}`;return Object.defineProperty(window,t,{value:s=>(e&&Reflect.deleteProperty(window,t),n==null?void 0:n(s)),writable:!1,configurable:!0}),r}var V,Ce=class{constructor(){this.__TAURI_CHANNEL_MARKER__=!0,qe(this,V,()=>{}),this.id=Z(n=>{fe(this,V).call(this,n)})}set onmessage(n){Be(this,V,n)}get onmessage(){return fe(this,V)}toJSON(){return`__CHANNEL__:${this.id}`}};V=new WeakMap;var Ee=class{constructor(n,e,r){this.plugin=n,this.event=e,this.channelId=r}async unregister(){return x(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}};async function ze(n,e,r){let t=new Ce;return t.onmessage=r,x(`plugin:${n}|register_listener`,{event:e,handler:t}).then(()=>new Ee(n,e,t.id))}async function x(n,e={}){return new Promise((r,t)=>{let s=Z(a=>{r(a),Reflect.deleteProperty(window,`_${i}`)},!0),i=Z(a=>{t(a),Reflect.deleteProperty(window,`_${s}`)},!0);window.__TAURI_IPC__({cmd:n,callback:s,error:i,...e})})}function Fe(n,e="asset"){let r=encodeURIComponent(n);return navigator.userAgent.includes("Windows")?`https://${e}.localhost/${r}`:`${e}://localhost/${r}`}var ue;(function(n){n.Year="Year",n.Month="Month",n.TwoWeeks="TwoWeeks",n.Week="Week",n.Day="Day",n.Hour="Hour",n.Minute="Minute",n.Second="Second"})(ue||(ue={}));var ce;(function(n){n[n.None=0]="None",n[n.Min=1]="Min",n[n.Low=2]="Low",n[n.Default=3]="Default",n[n.High=4]="High"})(ce||(ce={}));var he;(function(n){n[n.Secret=-1]="Secret",n[n.Private=0]="Private",n[n.Public=1]="Public"})(he||(he={}));async function Je(){return window.Notification.permission!=="default"?Promise.resolve(window.Notification.permission==="granted"):x("plugin:notification|is_permission_granted")}async function Qe(){return window.Notification.requestPermission()}function de(n){typeof n=="string"?new window.Notification(n):new window.Notification(n.title,n)}function me(n,e,r){const t=n.slice();return t[15]=e[r],t}function Xe(n){let e,r,t=ae(n[5]),s=[];for(let a=0;a<t.length;a+=1)s[a]=ge(me(n,t,a));const i=a=>$(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=X()},l(a){for(let f=0;f<s.length;f+=1)s[f].l(a);e=X()},m(a,f){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(a,f);O(a,e,f),r=!0},p(a,f){if(f&98){t=ae(a[5]);let o;for(o=0;o<t.length;o+=1){const h=me(a,t,o);s[o]?(s[o].p(h,f),P(s[o],1)):(s[o]=ge(h),s[o].c(),P(s[o],1),s[o].m(e.parentNode,e))}for(Y(),o=t.length;o<s.length;o+=1)i(o);G()}},i(a){if(!r){for(let f=0;f<t.length;f+=1)P(s[f]);r=!0}},o(a){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)$(s[f]);r=!1},d(a){a&&b(e),De(s,a)}}}function Ze(n){let e,r="Please Wait...";return{c(){e=C("p"),e.textContent=r,this.h()},l(t){e=E(t,"P",{class:!0,["data-svelte-h"]:!0}),we(e)!=="svelte-n9uvbj"&&(e.textContent=r),this.h()},h(){N(e,"class","p w-full")},m(t,s){O(t,e,s)},p:B,i:B,o:B,d(t){t&&b(e)}}}function xe(n){let e,r;return e=new ye({props:{isThisUser:!1,src:n[1][n[15].author].photo,msg:n[15]}}),{c(){z(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){J(e,t,s),r=!0},p(t,s){const i={};s&34&&(i.src=t[1][t[15].author].photo),s&32&&(i.msg=t[15]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){Q(e,t)}}}function et(n){let e,r;return e=new ye({props:{isThisUser:!0,src:n[6].photo,msg:n[15]}}),{c(){z(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){J(e,t,s),r=!0},p(t,s){const i={};s&64&&(i.src=t[6].photo),s&32&&(i.msg=t[15]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){Q(e,t)}}}function tt(n){let e,r,t,s=n[15].text+" - "+n[15].humanTime(),i,a;return{c(){e=C("div"),r=C("div"),t=C("p"),i=W(s),a=I(),this.h()},l(f){e=E(f,"DIV",{class:!0});var o=H(e);r=E(o,"DIV",{class:!0});var h=H(r);t=E(h,"P",{class:!0});var p=H(t);i=L(p,s),p.forEach(b),h.forEach(b),a=R(o),o.forEach(b),this.h()},h(){N(t,"class","text-xs lg:text-base"),N(r,"class","border-0 space-y-2 w-full mb-4 variant-filled-surface p-2 w-9/12 mx-auto rounded-xl"),N(e,"class","grid gap-4 text-center w-full")},m(f,o){O(f,e,o),m(e,r),m(r,t),m(t,i),m(e,a)},p(f,o){o&32&&s!==(s=f[15].text+" - "+f[15].humanTime())&&q(i,s)},i:B,o:B,d(f){f&&b(e)}}}function ge(n){let e,r,t,s;const i=[tt,et,xe],a=[];function f(o,h){return o[15].author==="SYSTEM"?0:o[15].author===o[6].name?1:2}return e=f(n),r=a[e]=i[e](n),{c(){r.c(),t=X()},l(o){r.l(o),t=X()},m(o,h){a[e].m(o,h),O(o,t,h),s=!0},p(o,h){let p=e;e=f(o),e===p?a[e].p(o,h):(Y(),$(a[p],1,1,()=>{a[p]=null}),G(),r=a[e],r?r.p(o,h):(r=a[e]=i[e](o),r.c()),P(r,1),r.m(t.parentNode,t))},i(o){s||(P(r),s=!0)},o(o){$(r),s=!1},d(o){o&&b(t),a[e].d(o)}}}function nt(n){let e,r,t,s,i,a,f=(n[2]?n[2]:"Loading...")+"",o,h,p,D="settings",U,w,k,T,A,g,l,u,c,d;const j=[Ze,Xe],S=[];function K(_,y){return!_[6].name||!_[1]||!_[5].length?0:1}return k=K(n),T=S[k]=j[k](n),l=new Se({props:{onclick:n[7],sendOnEnter:!0}}),{c(){e=C("div"),r=C("div"),t=C("a"),s=W("arrow_back_ios"),i=I(),a=C("h3"),o=W(f),h=I(),p=C("button"),p.textContent=D,U=I(),w=C("section"),T.c(),A=I(),g=C("div"),z(l.$$.fragment),this.h()},l(_){e=E(_,"DIV",{class:!0});var y=H(e);r=E(y,"DIV",{class:!0});var M=H(r);t=E(M,"A",{class:!0,href:!0});var te=H(t);s=L(te,"arrow_back_ios"),te.forEach(b),i=R(M),a=E(M,"H3",{class:!0});var ne=H(a);o=L(ne,f),ne.forEach(b),h=R(M),p=E(M,"BUTTON",{class:!0,["data-svelte-h"]:!0}),we(p)!=="svelte-qvcjja"&&(p.textContent=D),M.forEach(b),U=R(y),w=E(y,"SECTION",{class:!0});var re=H(w);T.l(re),re.forEach(b),A=R(y),g=E(y,"DIV",{});var se=H(g);F(l.$$.fragment,se),se.forEach(b),y.forEach(b),this.h()},h(){N(t,"class","btn-icon material-symbols-outlined w-8 h-8"),N(t,"href",Te+"/chatrooms"),N(a,"class","h3 px-2 my-auto"),N(p,"class","material-symbols-outlined ml-auto mr-3 w-8 h-8 my-auto"),N(r,"class","h-auto flex flex-row variant-filled-primary mt-4 p-1"),N(w,"class","p-1 overflow-y-auto space-y-4"),v(w,"placeholder",!n[5].length),v(w,"animate-pulse",!n[5].length),N(e,"class","flex flex-col overflow-hidden px-4 lg:pl-0")},m(_,y){O(_,e,y),m(e,r),m(r,t),m(t,s),m(r,i),m(r,a),m(a,o),m(r,h),m(r,p),n[9](r),m(e,U),m(e,w),S[k].m(w,null),n[10](w),m(e,A),m(e,g),J(l,g,null),n[11](g),u=!0,c||(d=Ne(p,"click",n[8]),c=!0)},p(_,[y]){(!u||y&4)&&f!==(f=(_[2]?_[2]:"Loading...")+"")&&q(o,f);let M=k;k=K(_),k===M?S[k].p(_,y):(Y(),$(S[M],1,1,()=>{S[M]=null}),G(),T=S[k],T?T.p(_,y):(T=S[k]=j[k](_),T.c()),P(T,1),T.m(w,null)),(!u||y&32)&&v(w,"placeholder",!_[5].length),(!u||y&32)&&v(w,"animate-pulse",!_[5].length)},i(_){u||(P(T),P(l.$$.fragment,_),u=!0)},o(_){$(T),$(l.$$.fragment,_),u=!1},d(_){_&&b(e),n[9](null),S[k].d(),n[10](null),Q(l),n[11](null),c=!1,d()}}}function _e(n){const e=n.offsetHeight,r=getComputedStyle(n),t=parseInt(r.getPropertyValue("margin-top")),s=parseInt(r.getPropertyValue("margin-bottom"));return e+t+s}function rt(n,e,r){let t;He(n,Ue,l=>r(6,t=l));async function s(){let l=await Je();l||(l=await Qe()==="granted"),l&&(de("Tauri is awesome!"),de({title:"TAURI",body:"Tauri is awesome!"}))}s();let i;var a;let f;var o,h;function p(){i?i.scrollTo({top:i.scrollHeight,behavior:"smooth"}):console.log(i)}var D=[];async function U(l){await We(t.cid,l)}function w(){return window.innerHeight-_e(o)-_e(h)}$e(async()=>{r(0,i.style.maxHeight=w().toString()+"px",i),r(0,i.style.minHeight=w().toString()+"px",i),t.token||Ie("Open a chatroom first!",()=>{Ae(Te+"/chatrooms")});const l=await oe(t.cid);r(1,a=l.users),r(2,f=l.name),r(5,D=await Re(t.cid)),setTimeout(p,150),je(t.cid,async u=>{Object.keys(a).includes(u.author)||r(1,a=(await oe(t.cid)).users),r(5,D=[...D,u]),setTimeout(p,75)},D.length),window.addEventListener("resize",()=>{try{r(0,i.style.maxHeight=w().toString()+"px",i),r(0,i.style.minHeight=w().toString()+"px",i)}catch{}})});async function k(){var l;window.innerWidth<=639?l={id:"drawerChat",width:"w-screen",height:"h-[220px]",padding:"p-4",rounded:"rounded-xl",position:"top"}:window.innerWidth<=1024?l={id:"drawerChat",width:"w-[340px]",height:"h-full",padding:"p-4",rounded:"rounded-xl",position:"right"}:l={id:"drawerChat",width:"w-[280px] md:w-[480px]",padding:"p-4",rounded:"rounded-xl",position:"right"},Me.open(l)}function T(l){ee[l?"unshift":"push"](()=>{o=l,r(3,o)})}function A(l){ee[l?"unshift":"push"](()=>{i=l,r(0,i)})}function g(l){ee[l?"unshift":"push"](()=>{h=l,r(4,h)})}return[i,a,f,o,h,D,t,U,k,T,A,g]}class dt extends ve{constructor(e){super(),be(this,e,rt,nt,pe,{})}}export{dt as component};
