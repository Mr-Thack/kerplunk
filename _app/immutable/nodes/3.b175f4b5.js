import{s as we,f as C,a as I,l as W,g as E,h as H,c as R,m as L,d as b,j as $,U as v,i as O,u as m,n as q,T as ve,C as He,I as Ne,o as Se,S as De,p as ee,e as X,R as Me,K as B}from"../chunks/scheduler.2996579b.js";import{S as be,i as ke,a as P,g as Y,t as N,c as G,b as z,d as F,m as J,e as Q}from"../chunks/index.00b56f8c.js";import{e as oe}from"../chunks/each.4e61ef43.js";import{a as Te,K as Ue,d as Ae}from"../chunks/KTextArea.b9d9b606.js";import{u as ae}from"../chunks/stores.0e991afd.js";import{g as Ie}from"../chunks/navigation.c4786c61.js";import{f as Re}from"../chunks/alerts.73a0c392.js";import{b as ye}from"../chunks/paths.ee880fa4.js";import{g as ie,a as je,s as We,b as Le}from"../chunks/convo.3dfd8fc3.js";function le(n){let e,r;return e=new Te({props:{src:n[1]}}),{c(){z(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){J(e,t,s),r=!0},p(t,s){const i={};s&2&&(i.src=t[1]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){N(e.$$.fragment,t),r=!1},d(t){Q(e,t)}}}function fe(n){let e,r;return e=new Te({props:{src:n[1]}}),{c(){z(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){J(e,t,s),r=!0},p(t,s){const i={};s&2&&(i.src=t[1]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){N(e.$$.fragment,t),r=!1},d(t){Q(e,t)}}}function Oe(n){let e,r,t,s,i,o=n[2].author+"",f,a,h,p=n[2].humanTime()+"",S,U,w,k=n[2].text+"",T,A,g,l=!n[0]&&le(n),c=n[0]&&fe(n);return{c(){e=C("div"),l&&l.c(),r=I(),t=C("div"),s=C("header"),i=C("p"),f=W(o),a=I(),h=C("p"),S=W(p),U=I(),w=C("p"),T=W(k),A=I(),c&&c.c(),this.h()},l(u){e=E(u,"DIV",{class:!0});var d=H(e);l&&l.l(d),r=R(d),t=E(d,"DIV",{class:!0});var j=H(t);s=E(j,"HEADER",{class:!0});var D=H(s);i=E(D,"P",{class:!0});var K=H(i);f=L(K,o),K.forEach(b),a=R(D),h=E(D,"P",{class:!0});var _=H(h);S=L(_,p),_.forEach(b),D.forEach(b),U=R(j),w=E(j,"P",{class:!0});var y=H(w);T=L(y,k),y.forEach(b),j.forEach(b),A=R(d),c&&c.l(d),d.forEach(b),this.h()},h(){$(i,"class","font-bold text-xs lg:text-base mr-4"),$(h,"class","text-xs lg:text-base"),$(s,"class","flex justify-between items-center"),$(w,"class","text-xs lg:text-base"),$(t,"class","card p-2 lg:p-4 space-y-2"),v(t,"rounded-tr-none",n[0]),v(t,"rounded-tl-none",!n[0]),v(t,"variant-filled-primary",n[0]),v(t,"variant-soft",!n[0]),$(e,"class","grid lg:gap-2"),v(e,"grid-cols-[1fr_auto_auto]",n[0]),v(e,"grid-cols-[auto_auto_1fr]",!n[0]),v(e,"justify-items-end",n[0]),v(e,"text-right",n[0]),v(e,"text-left",!n[0])},m(u,d){O(u,e,d),l&&l.m(e,null),m(e,r),m(e,t),m(t,s),m(s,i),m(i,f),m(s,a),m(s,h),m(h,S),m(t,U),m(t,w),m(w,T),m(e,A),c&&c.m(e,null),g=!0},p(u,[d]){u[0]?l&&(Y(),N(l,1,1,()=>{l=null}),G()):l?(l.p(u,d),d&1&&P(l,1)):(l=le(u),l.c(),P(l,1),l.m(e,r)),(!g||d&4)&&o!==(o=u[2].author+"")&&q(f,o),(!g||d&4)&&p!==(p=u[2].humanTime()+"")&&q(S,p),(!g||d&4)&&k!==(k=u[2].text+"")&&q(T,k),(!g||d&1)&&v(t,"rounded-tr-none",u[0]),(!g||d&1)&&v(t,"rounded-tl-none",!u[0]),(!g||d&1)&&v(t,"variant-filled-primary",u[0]),(!g||d&1)&&v(t,"variant-soft",!u[0]),u[0]?c?(c.p(u,d),d&1&&P(c,1)):(c=fe(u),c.c(),P(c,1),c.m(e,null)):c&&(Y(),N(c,1,1,()=>{c=null}),G()),(!g||d&1)&&v(e,"grid-cols-[1fr_auto_auto]",u[0]),(!g||d&1)&&v(e,"grid-cols-[auto_auto_1fr]",!u[0]),(!g||d&1)&&v(e,"justify-items-end",u[0]),(!g||d&1)&&v(e,"text-right",u[0]),(!g||d&1)&&v(e,"text-left",!u[0])},i(u){g||(P(l),P(c),g=!0)},o(u){N(l),N(c),g=!1},d(u){u&&b(e),l&&l.d(),c&&c.d()}}}function Ke(n,e,r){let{isThisUser:t}=e,{src:s}=e,{msg:i}=e;return n.$$set=o=>{"isThisUser"in o&&r(0,t=o.isThisUser),"src"in o&&r(1,s=o.src),"msg"in o&&r(2,i=o.msg)},[t,s,i]}class Pe extends be{constructor(e){super(),ke(this,e,Ke,Oe,we,{isThisUser:0,src:1,msg:2})}}var Ve=Object.defineProperty,qe=(n,e)=>{for(var r in e)Ve(n,r,{get:e[r],enumerable:!0})},Ce=(n,e,r)=>{if(!e.has(n))throw TypeError("Cannot "+r)},ce=(n,e,r)=>(Ce(n,e,"read from private field"),r?r.call(n):e.get(n)),Be=(n,e,r)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,r)},Ye=(n,e,r,t)=>(Ce(n,e,"write to private field"),t?t.call(n,r):e.set(n,r),r),Ge={};qe(Ge,{Channel:()=>Ee,PluginListener:()=>$e,addPluginListener:()=>Fe,convertFileSrc:()=>Je,invoke:()=>x,transformCallback:()=>Z});function ze(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function Z(n,e=!1){let r=ze(),t=`_${r}`;return Object.defineProperty(window,t,{value:s=>(e&&Reflect.deleteProperty(window,t),n==null?void 0:n(s)),writable:!1,configurable:!0}),r}var V,Ee=class{constructor(){this.__TAURI_CHANNEL_MARKER__=!0,Be(this,V,()=>{}),this.id=Z(n=>{ce(this,V).call(this,n)})}set onmessage(n){Ye(this,V,n)}get onmessage(){return ce(this,V)}toJSON(){return`__CHANNEL__:${this.id}`}};V=new WeakMap;var $e=class{constructor(n,e,r){this.plugin=n,this.event=e,this.channelId=r}async unregister(){return x(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}};async function Fe(n,e,r){let t=new Ee;return t.onmessage=r,x(`plugin:${n}|register_listener`,{event:e,handler:t}).then(()=>new $e(n,e,t.id))}async function x(n,e={}){return new Promise((r,t)=>{let s=Z(o=>{r(o),Reflect.deleteProperty(window,`_${i}`)},!0),i=Z(o=>{t(o),Reflect.deleteProperty(window,`_${s}`)},!0);window.__TAURI_IPC__({cmd:n,callback:s,error:i,...e})})}function Je(n,e="asset"){let r=encodeURIComponent(n);return navigator.userAgent.includes("Windows")?`https://${e}.localhost/${r}`:`${e}://localhost/${r}`}var ue;(function(n){n.Year="Year",n.Month="Month",n.TwoWeeks="TwoWeeks",n.Week="Week",n.Day="Day",n.Hour="Hour",n.Minute="Minute",n.Second="Second"})(ue||(ue={}));var he;(function(n){n[n.None=0]="None",n[n.Min=1]="Min",n[n.Low=2]="Low",n[n.Default=3]="Default",n[n.High=4]="High"})(he||(he={}));var de;(function(n){n[n.Secret=-1]="Secret",n[n.Private=0]="Private",n[n.Public=1]="Public"})(de||(de={}));async function Qe(){return window.Notification.permission!=="default"?Promise.resolve(window.Notification.permission==="granted"):x("plugin:notification|is_permission_granted")}async function Xe(){return window.Notification.requestPermission()}function me(n){typeof n=="string"?new window.Notification(n):new window.Notification(n.title,n)}function ge(n,e,r){const t=n.slice();return t[16]=e[r],t}function Ze(n){let e,r,t=oe(n[4]),s=[];for(let o=0;o<t.length;o+=1)s[o]=_e(ge(n,t,o));const i=o=>N(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=X()},l(o){for(let f=0;f<s.length;f+=1)s[f].l(o);e=X()},m(o,f){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,f);O(o,e,f),r=!0},p(o,f){if(f&50){t=oe(o[4]);let a;for(a=0;a<t.length;a+=1){const h=ge(o,t,a);s[a]?(s[a].p(h,f),P(s[a],1)):(s[a]=_e(h),s[a].c(),P(s[a],1),s[a].m(e.parentNode,e))}for(Y(),a=t.length;a<s.length;a+=1)i(a);G()}},i(o){if(!r){for(let f=0;f<t.length;f+=1)P(s[f]);r=!0}},o(o){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)N(s[f]);r=!1},d(o){o&&b(e),Me(s,o)}}}function xe(n){let e,r="Please Wait...";return{c(){e=C("p"),e.textContent=r,this.h()},l(t){e=E(t,"P",{class:!0,["data-svelte-h"]:!0}),ve(e)!=="svelte-n9uvbj"&&(e.textContent=r),this.h()},h(){$(e,"class","p w-full")},m(t,s){O(t,e,s)},p:B,i:B,o:B,d(t){t&&b(e)}}}function et(n){let e,r;return e=new Pe({props:{isThisUser:!1,src:n[1][n[16].author].photo,msg:n[16]}}),{c(){z(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){J(e,t,s),r=!0},p(t,s){const i={};s&18&&(i.src=t[1][t[16].author].photo),s&16&&(i.msg=t[16]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){N(e.$$.fragment,t),r=!1},d(t){Q(e,t)}}}function tt(n){let e,r;return e=new Pe({props:{isThisUser:!0,src:n[5].photo,msg:n[16]}}),{c(){z(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){J(e,t,s),r=!0},p(t,s){const i={};s&32&&(i.src=t[5].photo),s&16&&(i.msg=t[16]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){N(e.$$.fragment,t),r=!1},d(t){Q(e,t)}}}function nt(n){let e,r,t,s=n[16].text+" - "+n[16].humanTime(),i,o;return{c(){e=C("div"),r=C("div"),t=C("p"),i=W(s),o=I(),this.h()},l(f){e=E(f,"DIV",{class:!0});var a=H(e);r=E(a,"DIV",{class:!0});var h=H(r);t=E(h,"P",{class:!0});var p=H(t);i=L(p,s),p.forEach(b),h.forEach(b),o=R(a),a.forEach(b),this.h()},h(){$(t,"class","text-xs lg:text-base"),$(r,"class","border-0 space-y-2 w-full mb-4 variant-filled-surface p-2 w-9/12 mx-auto rounded-xl"),$(e,"class","grid gap-4 text-center w-full")},m(f,a){O(f,e,a),m(e,r),m(r,t),m(t,i),m(e,o)},p(f,a){a&16&&s!==(s=f[16].text+" - "+f[16].humanTime())&&q(i,s)},i:B,o:B,d(f){f&&b(e)}}}function _e(n){let e,r,t,s;const i=[nt,tt,et],o=[];function f(a,h){return a[16].author==="SYSTEM"?0:a[16].author===a[5].name?1:2}return e=f(n),r=o[e]=i[e](n),{c(){r.c(),t=X()},l(a){r.l(a),t=X()},m(a,h){o[e].m(a,h),O(a,t,h),s=!0},p(a,h){let p=e;e=f(a),e===p?o[e].p(a,h):(Y(),N(o[p],1,1,()=>{o[p]=null}),G(),r=o[e],r?r.p(a,h):(r=o[e]=i[e](a),r.c()),P(r,1),r.m(t.parentNode,t))},i(a){s||(P(r),s=!0)},o(a){N(r),s=!1},d(a){a&&b(t),o[e].d(a)}}}function rt(n){let e,r,t,s,i,o,f=(n[5].convo?n[5].convo:"Loading...")+"",a,h,p,S="settings",U,w,k,T,A,g,l,c,u,d;const j=[xe,Ze],D=[];function K(_,y){return!_[5].name||!_[1]||!_[4].length?0:1}return k=K(n),T=D[k]=j[k](n),l=new Ue({props:{onclick:n[6],sendOnEnter:!0}}),{c(){e=C("div"),r=C("div"),t=C("a"),s=W("arrow_back_ios"),i=I(),o=C("h3"),a=W(f),h=I(),p=C("button"),p.textContent=S,U=I(),w=C("section"),T.c(),A=I(),g=C("div"),z(l.$$.fragment),this.h()},l(_){e=E(_,"DIV",{class:!0});var y=H(e);r=E(y,"DIV",{class:!0});var M=H(r);t=E(M,"A",{class:!0,href:!0});var te=H(t);s=L(te,"arrow_back_ios"),te.forEach(b),i=R(M),o=E(M,"H3",{class:!0});var ne=H(o);a=L(ne,f),ne.forEach(b),h=R(M),p=E(M,"BUTTON",{class:!0,["data-svelte-h"]:!0}),ve(p)!=="svelte-qvcjja"&&(p.textContent=S),M.forEach(b),U=R(y),w=E(y,"SECTION",{class:!0});var re=H(w);T.l(re),re.forEach(b),A=R(y),g=E(y,"DIV",{});var se=H(g);F(l.$$.fragment,se),se.forEach(b),y.forEach(b),this.h()},h(){$(t,"class","btn-icon material-symbols-outlined w-8 h-8"),$(t,"href",ye+"/chatrooms"),$(o,"class","h3 px-2 my-auto"),$(p,"class","material-symbols-outlined ml-auto mr-3 w-8 h-8 my-auto"),$(r,"class","h-auto flex flex-row variant-filled-primary mt-4 p-1"),$(w,"class","p-1 overflow-y-auto space-y-4"),v(w,"placeholder",!n[4].length),v(w,"animate-pulse",!n[4].length),$(e,"class","flex flex-col overflow-hidden px-4 lg:pl-0")},m(_,y){O(_,e,y),m(e,r),m(r,t),m(t,s),m(r,i),m(r,o),m(o,a),m(r,h),m(r,p),n[8](r),m(e,U),m(e,w),D[k].m(w,null),n[9](w),m(e,A),m(e,g),J(l,g,null),n[10](g),c=!0,u||(d=He(p,"click",n[7]),u=!0)},p(_,[y]){(!c||y&32)&&f!==(f=(_[5].convo?_[5].convo:"Loading...")+"")&&q(a,f);let M=k;k=K(_),k===M?D[k].p(_,y):(Y(),N(D[M],1,1,()=>{D[M]=null}),G(),T=D[k],T?T.p(_,y):(T=D[k]=j[k](_),T.c()),P(T,1),T.m(w,null)),(!c||y&16)&&v(w,"placeholder",!_[4].length),(!c||y&16)&&v(w,"animate-pulse",!_[4].length)},i(_){c||(P(T),P(l.$$.fragment,_),c=!0)},o(_){N(T),N(l.$$.fragment,_),c=!1},d(_){_&&b(e),n[8](null),D[k].d(),n[9](null),Q(l),n[10](null),u=!1,d()}}}function pe(n){const e=n.offsetHeight,r=getComputedStyle(n),t=parseInt(r.getPropertyValue("margin-top")),s=parseInt(r.getPropertyValue("margin-bottom"));return e+t+s}function st(n,e,r){let t;Ne(n,ae,l=>r(5,t=l));async function s(){let l=await Qe();l||await Xe().then(c=>{l=c==="granted"}),l&&(me("Tauri is awesome!"),me({title:"TAURI",body:"Tauri is awesome!"}))}s();let i;var o,f,a,h;function p(){i?i.scrollTo({top:i.scrollHeight,behavior:"smooth"}):console.log(i)}var S=[];async function U(l){await Le(t.cid,l)}function w(){return window.innerHeight-pe(a)-pe(h)}Se(async()=>{r(0,i.style.maxHeight=w().toString()+"px",i),r(0,i.style.minHeight=w().toString()+"px",i),t.token||Re("Open a chatroom first!",()=>{Ie(ye+"/chatrooms")});const l=await ie(t.cid);r(1,o=l.users),De(ae,t.convo=l.name,t),f=l.owner,r(4,S=await je(t.cid)),setTimeout(p,150),We(t.cid,async c=>{Object.keys(o).includes(c.author)||r(1,o=(await ie(t.cid)).users),r(4,S=[...S,c]),setTimeout(p,75)},S.length),window.addEventListener("resize",()=>{try{r(0,i.style.maxHeight=w().toString()+"px",i),r(0,i.style.minHeight=w().toString()+"px",i)}catch{}})});async function k(){var l;window.innerWidth<=639?l={id:"drawerChat",width:"w-screen",height:"h-[220px]",padding:"p-4",rounded:"rounded-xl",position:"top",meta:{owner:t.name===f,cid:t.cid}}:window.innerWidth<=1024?l={id:"drawerChat",width:"w-[340px]",height:"h-full",padding:"p-4",rounded:"rounded-xl",position:"right",meta:{owner:t.name===f,cid:t.cid}}:l={id:"drawerChat",width:"w-[280px] md:w-[480px]",padding:"p-4",rounded:"rounded-xl",position:"right",meta:{owner:t.name===f,cid:t.cid}},Ae.open(l)}function T(l){ee[l?"unshift":"push"](()=>{a=l,r(2,a)})}function A(l){ee[l?"unshift":"push"](()=>{i=l,r(0,i)})}function g(l){ee[l?"unshift":"push"](()=>{h=l,r(3,h)})}return[i,o,a,h,S,t,U,k,T,A,g]}class mt extends be{constructor(e){super(),ke(this,e,st,rt,we,{})}}export{mt as component};
