import{s as ge,f as E,a as A,l as j,g as C,h as H,c as I,m as L,d as b,j as N,U as w,i as O,u as g,n as V,T as de,I as ye,o as Ee,p as x,e as Q,R as Ce,K as B}from"../chunks/scheduler.2996579b.js";import{S as pe,i as ve,a as y,g as q,t as $,c as Y,b as G,d as z,m as F,e as J}from"../chunks/index.00b56f8c.js";import{e as se}from"../chunks/each.4e61ef43.js";import{a as we,K as Ne}from"../chunks/KTextArea.86e1920a.js";import{u as He}from"../chunks/stores.88811b96.js";import{g as $e}from"../chunks/navigation.0345319d.js";import{f as De}from"../chunks/alerts.73a0c392.js";import{b as Me}from"../chunks/paths.00efb4fb.js";import{g as re,a as Se,s as Ue,b as Ae}from"../chunks/convo.53645883.js";function ae(n){let e,s;return e=new we({props:{src:n[1]}}),{c(){G(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,r){F(e,t,r),s=!0},p(t,r){const i={};r&2&&(i.src=t[1]),e.$set(i)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){$(e.$$.fragment,t),s=!1},d(t){J(e,t)}}}function oe(n){let e,s;return e=new we({props:{src:n[1]}}),{c(){G(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,r){F(e,t,r),s=!0},p(t,r){const i={};r&2&&(i.src=t[1]),e.$set(i)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){$(e.$$.fragment,t),s=!1},d(t){J(e,t)}}}function Ie(n){let e,s,t,r,i,a=n[2].author+"",l,o,m,v=n[2].humanTime()+"",D,S,p,k=n[2].text+"",T,U,f,u=!n[0]&&ae(n),_=n[0]&&oe(n);return{c(){e=E("div"),u&&u.c(),s=A(),t=E("div"),r=E("header"),i=E("p"),l=j(a),o=A(),m=E("p"),D=j(v),S=A(),p=E("p"),T=j(k),U=A(),_&&_.c(),this.h()},l(h){e=C(h,"DIV",{class:!0});var c=H(e);u&&u.l(c),s=I(c),t=C(c,"DIV",{class:!0});var R=H(t);r=C(R,"HEADER",{class:!0});var d=H(r);i=C(d,"P",{class:!0});var P=H(i);l=L(P,a),P.forEach(b),o=I(d),m=C(d,"P",{class:!0});var M=H(m);D=L(M,v),M.forEach(b),d.forEach(b),S=I(R),p=C(R,"P",{class:!0});var W=H(p);T=L(W,k),W.forEach(b),R.forEach(b),U=I(c),_&&_.l(c),c.forEach(b),this.h()},h(){N(i,"class","font-bold text-xs lg:text-base mr-4"),N(m,"class","text-xs lg:text-base"),N(r,"class","flex justify-between items-center"),N(p,"class","text-xs lg:text-base"),N(t,"class","card p-2 lg:p-4 space-y-2"),w(t,"rounded-tr-none",n[0]),w(t,"rounded-tl-none",!n[0]),w(t,"variant-filled-primary",n[0]),w(t,"variant-soft",!n[0]),N(e,"class","grid lg:gap-2"),w(e,"grid-cols-[1fr_auto_auto]",n[0]),w(e,"grid-cols-[auto_auto_1fr]",!n[0]),w(e,"justify-items-end",n[0]),w(e,"text-right",n[0]),w(e,"text-left",!n[0])},m(h,c){O(h,e,c),u&&u.m(e,null),g(e,s),g(e,t),g(t,r),g(r,i),g(i,l),g(r,o),g(r,m),g(m,D),g(t,S),g(t,p),g(p,T),g(e,U),_&&_.m(e,null),f=!0},p(h,[c]){h[0]?u&&(q(),$(u,1,1,()=>{u=null}),Y()):u?(u.p(h,c),c&1&&y(u,1)):(u=ae(h),u.c(),y(u,1),u.m(e,s)),(!f||c&4)&&a!==(a=h[2].author+"")&&V(l,a),(!f||c&4)&&v!==(v=h[2].humanTime()+"")&&V(D,v),(!f||c&4)&&k!==(k=h[2].text+"")&&V(T,k),(!f||c&1)&&w(t,"rounded-tr-none",h[0]),(!f||c&1)&&w(t,"rounded-tl-none",!h[0]),(!f||c&1)&&w(t,"variant-filled-primary",h[0]),(!f||c&1)&&w(t,"variant-soft",!h[0]),h[0]?_?(_.p(h,c),c&1&&y(_,1)):(_=oe(h),_.c(),y(_,1),_.m(e,null)):_&&(q(),$(_,1,1,()=>{_=null}),Y()),(!f||c&1)&&w(e,"grid-cols-[1fr_auto_auto]",h[0]),(!f||c&1)&&w(e,"grid-cols-[auto_auto_1fr]",!h[0]),(!f||c&1)&&w(e,"justify-items-end",h[0]),(!f||c&1)&&w(e,"text-right",h[0]),(!f||c&1)&&w(e,"text-left",!h[0])},i(h){f||(y(u),y(_),f=!0)},o(h){$(u),$(_),f=!1},d(h){h&&b(e),u&&u.d(),_&&_.d()}}}function Re(n,e,s){let{isThisUser:t}=e,{src:r}=e,{msg:i}=e;return n.$$set=a=>{"isThisUser"in a&&s(0,t=a.isThisUser),"src"in a&&s(1,r=a.src),"msg"in a&&s(2,i=a.msg)},[t,r,i]}class be extends pe{constructor(e){super(),ve(this,e,Re,Ie,ge,{isThisUser:0,src:1,msg:2})}}var je=Object.defineProperty,Le=(n,e)=>{for(var s in e)je(n,s,{get:e[s],enumerable:!0})},ke=(n,e,s)=>{if(!e.has(n))throw TypeError("Cannot "+s)},ie=(n,e,s)=>(ke(n,e,"read from private field"),s?s.call(n):e.get(n)),Oe=(n,e,s)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,s)},We=(n,e,s,t)=>(ke(n,e,"write to private field"),t?t.call(n,s):e.set(n,s),s),Ke={};Le(Ke,{Channel:()=>Te,PluginListener:()=>Pe,addPluginListener:()=>Be,convertFileSrc:()=>qe,invoke:()=>Z,transformCallback:()=>X});function Ve(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function X(n,e=!1){let s=Ve(),t=`_${s}`;return Object.defineProperty(window,t,{value:r=>(e&&Reflect.deleteProperty(window,t),n==null?void 0:n(r)),writable:!1,configurable:!0}),s}var K,Te=class{constructor(){this.__TAURI_CHANNEL_MARKER__=!0,Oe(this,K,()=>{}),this.id=X(n=>{ie(this,K).call(this,n)})}set onmessage(n){We(this,K,n)}get onmessage(){return ie(this,K)}toJSON(){return`__CHANNEL__:${this.id}`}};K=new WeakMap;var Pe=class{constructor(n,e,s){this.plugin=n,this.event=e,this.channelId=s}async unregister(){return Z(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}};async function Be(n,e,s){let t=new Te;return t.onmessage=s,Z(`plugin:${n}|register_listener`,{event:e,handler:t}).then(()=>new Pe(n,e,t.id))}async function Z(n,e={}){return new Promise((s,t)=>{let r=X(a=>{s(a),Reflect.deleteProperty(window,`_${i}`)},!0),i=X(a=>{t(a),Reflect.deleteProperty(window,`_${r}`)},!0);window.__TAURI_IPC__({cmd:n,callback:r,error:i,...e})})}function qe(n,e="asset"){let s=encodeURIComponent(n);return navigator.userAgent.includes("Windows")?`https://${e}.localhost/${s}`:`${e}://localhost/${s}`}var le;(function(n){n.Year="Year",n.Month="Month",n.TwoWeeks="TwoWeeks",n.Week="Week",n.Day="Day",n.Hour="Hour",n.Minute="Minute",n.Second="Second"})(le||(le={}));var fe;(function(n){n[n.None=0]="None",n[n.Min=1]="Min",n[n.Low=2]="Low",n[n.Default=3]="Default",n[n.High=4]="High"})(fe||(fe={}));var ce;(function(n){n[n.Secret=-1]="Secret",n[n.Private=0]="Private",n[n.Public=1]="Public"})(ce||(ce={}));async function Ye(){return window.Notification.permission!=="default"?Promise.resolve(window.Notification.permission==="granted"):Z("plugin:notification|is_permission_granted")}async function Ge(){return window.Notification.requestPermission()}function ue(n){typeof n=="string"?new window.Notification(n):new window.Notification(n.title,n)}function he(n,e,s){const t=n.slice();return t[14]=e[s],t}function ze(n){let e,s,t=se(n[5]),r=[];for(let a=0;a<t.length;a+=1)r[a]=me(he(n,t,a));const i=a=>$(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();e=Q()},l(a){for(let l=0;l<r.length;l+=1)r[l].l(a);e=Q()},m(a,l){for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(a,l);O(a,e,l),s=!0},p(a,l){if(l&98){t=se(a[5]);let o;for(o=0;o<t.length;o+=1){const m=he(a,t,o);r[o]?(r[o].p(m,l),y(r[o],1)):(r[o]=me(m),r[o].c(),y(r[o],1),r[o].m(e.parentNode,e))}for(q(),o=t.length;o<r.length;o+=1)i(o);Y()}},i(a){if(!s){for(let l=0;l<t.length;l+=1)y(r[l]);s=!0}},o(a){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)$(r[l]);s=!1},d(a){a&&b(e),Ce(r,a)}}}function Fe(n){let e,s="Please Wait...";return{c(){e=E("p"),e.textContent=s,this.h()},l(t){e=C(t,"P",{class:!0,["data-svelte-h"]:!0}),de(e)!=="svelte-n9uvbj"&&(e.textContent=s),this.h()},h(){N(e,"class","p w-full")},m(t,r){O(t,e,r)},p:B,i:B,o:B,d(t){t&&b(e)}}}function Je(n){let e,s;return e=new be({props:{isThisUser:!1,src:n[1][n[14].author].photo,msg:n[14]}}),{c(){G(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,r){F(e,t,r),s=!0},p(t,r){const i={};r&34&&(i.src=t[1][t[14].author].photo),r&32&&(i.msg=t[14]),e.$set(i)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){$(e.$$.fragment,t),s=!1},d(t){J(e,t)}}}function Qe(n){let e,s;return e=new be({props:{isThisUser:!0,src:n[6].photo,msg:n[14]}}),{c(){G(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,r){F(e,t,r),s=!0},p(t,r){const i={};r&64&&(i.src=t[6].photo),r&32&&(i.msg=t[14]),e.$set(i)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){$(e.$$.fragment,t),s=!1},d(t){J(e,t)}}}function Xe(n){let e,s,t,r=n[14].text+" - "+n[14].humanTime(),i,a;return{c(){e=E("div"),s=E("div"),t=E("p"),i=j(r),a=A(),this.h()},l(l){e=C(l,"DIV",{class:!0});var o=H(e);s=C(o,"DIV",{class:!0});var m=H(s);t=C(m,"P",{class:!0});var v=H(t);i=L(v,r),v.forEach(b),m.forEach(b),a=I(o),o.forEach(b),this.h()},h(){N(t,"class","text-xs lg:text-base"),N(s,"class","border-0 space-y-2 w-full mb-4 variant-filled-surface p-2 w-9/12 mx-auto rounded-xl"),N(e,"class","grid gap-4 text-center w-full")},m(l,o){O(l,e,o),g(e,s),g(s,t),g(t,i),g(e,a)},p(l,o){o&32&&r!==(r=l[14].text+" - "+l[14].humanTime())&&V(i,r)},i:B,o:B,d(l){l&&b(e)}}}function me(n){let e,s,t,r;const i=[Xe,Qe,Je],a=[];function l(o,m){return o[14].author==="SYSTEM"?0:o[14].author===o[6].name?1:2}return e=l(n),s=a[e]=i[e](n),{c(){s.c(),t=Q()},l(o){s.l(o),t=Q()},m(o,m){a[e].m(o,m),O(o,t,m),r=!0},p(o,m){let v=e;e=l(o),e===v?a[e].p(o,m):(q(),$(a[v],1,1,()=>{a[v]=null}),Y(),s=a[e],s?s.p(o,m):(s=a[e]=i[e](o),s.c()),y(s,1),s.m(t.parentNode,t))},i(o){r||(y(s),r=!0)},o(o){$(s),r=!1},d(o){o&&b(t),a[e].d(o)}}}function Ze(n){let e,s,t,r,i,a,l=(n[2]?n[2]:"Loading...")+"",o,m,v,D="settings",S,p,k,T,U,f,u,_;const h=[Fe,ze],c=[];function R(d,P){return!d[6].name||!d[1]||!d[5].length?0:1}return k=R(n),T=c[k]=h[k](n),u=new Ne({props:{onclick:n[7],sendOnEnter:!0}}),{c(){e=E("div"),s=E("div"),t=E("a"),r=j("arrow_back_ios"),i=A(),a=E("h3"),o=j(l),m=A(),v=E("button"),v.textContent=D,S=A(),p=E("section"),T.c(),U=A(),f=E("div"),G(u.$$.fragment),this.h()},l(d){e=C(d,"DIV",{class:!0});var P=H(e);s=C(P,"DIV",{class:!0});var M=H(s);t=C(M,"A",{class:!0,href:!0});var W=H(t);r=L(W,"arrow_back_ios"),W.forEach(b),i=I(M),a=C(M,"H3",{class:!0});var ee=H(a);o=L(ee,l),ee.forEach(b),m=I(M),v=C(M,"BUTTON",{class:!0,["data-svelte-h"]:!0}),de(v)!=="svelte-1o7k9cj"&&(v.textContent=D),M.forEach(b),S=I(P),p=C(P,"SECTION",{class:!0});var te=H(p);T.l(te),te.forEach(b),U=I(P),f=C(P,"DIV",{});var ne=H(f);z(u.$$.fragment,ne),ne.forEach(b),P.forEach(b),this.h()},h(){N(t,"class","btn-icon material-symbols-outlined w-8 h-8"),N(t,"href",Me+"/chatrooms"),N(a,"class","h3 px-2 my-auto"),N(v,"class","material-symbols-outlined ml-auto mr-3 w-8 h-8 my-auto"),N(s,"class","h-auto flex flex-row variant-filled-primary mt-4 p-1"),N(p,"class","p-1 overflow-y-auto space-y-4"),w(p,"placeholder",!n[5].length),w(p,"animate-pulse",!n[5].length),N(e,"class","flex flex-col overflow-hidden px-4 lg:pl-0")},m(d,P){O(d,e,P),g(e,s),g(s,t),g(t,r),g(s,i),g(s,a),g(a,o),g(s,m),g(s,v),n[8](s),g(e,S),g(e,p),c[k].m(p,null),n[9](p),g(e,U),g(e,f),F(u,f,null),n[10](f),_=!0},p(d,[P]){(!_||P&4)&&l!==(l=(d[2]?d[2]:"Loading...")+"")&&V(o,l);let M=k;k=R(d),k===M?c[k].p(d,P):(q(),$(c[M],1,1,()=>{c[M]=null}),Y(),T=c[k],T?T.p(d,P):(T=c[k]=h[k](d),T.c()),y(T,1),T.m(p,null)),(!_||P&32)&&w(p,"placeholder",!d[5].length),(!_||P&32)&&w(p,"animate-pulse",!d[5].length)},i(d){_||(y(T),y(u.$$.fragment,d),_=!0)},o(d){$(T),$(u.$$.fragment,d),_=!1},d(d){d&&b(e),n[8](null),c[k].d(),n[9](null),J(u),n[10](null)}}}function _e(n){const e=n.offsetHeight,s=getComputedStyle(n),t=parseInt(s.getPropertyValue("margin-top")),r=parseInt(s.getPropertyValue("margin-bottom"));return e+t+r}function xe(n,e,s){let t;ye(n,He,f=>s(6,t=f));async function r(){let f=await Ye();f||(f=await Ge()==="granted"),f&&(ue("Tauri is awesome!"),ue({title:"TAURI",body:"Tauri is awesome!"}))}r();let i;var a;let l;var o,m;function v(){i?i.scrollTo({top:i.scrollHeight,behavior:"smooth"}):console.log(i)}var D=[];async function S(f){await Ae(t.cid,f)}function p(){return window.innerHeight-_e(o)-_e(m)}Ee(async()=>{s(0,i.style.maxHeight=p().toString()+"px",i),s(0,i.style.minHeight=p().toString()+"px",i),t.token||De("Open a chatroom first!",()=>{$e("/chatrooms")});const f=await re(t.cid);s(1,a=f.users),s(2,l=f.name),s(5,D=await Se(t.cid)),setTimeout(v,150),Ue(t.cid,async u=>{Object.keys(a).includes(u.author)||s(1,a=(await re(t.cid)).users),s(5,D=[...D,u]),setTimeout(v,75)},D.length),window.addEventListener("resize",()=>{try{s(0,i.style.maxHeight=p().toString()+"px",i),s(0,i.style.minHeight=p().toString()+"px",i)}catch{}})});function k(f){x[f?"unshift":"push"](()=>{o=f,s(3,o)})}function T(f){x[f?"unshift":"push"](()=>{i=f,s(0,i)})}function U(f){x[f?"unshift":"push"](()=>{m=f,s(4,m)})}return[i,a,l,o,m,D,t,S,k,T,U]}class ft extends pe{constructor(e){super(),ve(this,e,xe,Ze,ge,{})}}export{ft as component};
